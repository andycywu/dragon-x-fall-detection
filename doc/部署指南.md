# 龍翔 X 跌倒偵測系統部署指南

本文檔提供將龍翔 X 跌倒偵測系統從 Mac 開發環境部署到 Qualcomm Device Cloud Windows 環境的詳細說明。

## 前置條件

部署系統需要以下工具：

- Python 3.7+
- Git
- SSH 客戶端
- SCP 檔案傳輸工具
- SSH 密鑰（預設：`qdc_id_2025-8-11_62.pem`）

## 部署方式概述

我們提供了三種部署方式：

1. **直接部署**：通過 SSH/SCP 直接將檔案部署到目標裝置
2. **AWS 虛擬攝影機部署**：部署和測試 AWS 虛擬攝影機相關功能
3. **GitHub 部署**：將專案發佈到 GitHub，再從裝置上拉取

您可以選擇其中一種或組合使用。對於日常開發，建議使用 GitHub 部署，以便輕鬆更新和管理代碼。

## 主要部署腳本

系統提供了四個主要部署腳本：

1. `integrated_deployment.py` - 整合所有部署方式
2. `deploy_to_device_cloud.py` - 直接部署到裝置
3. `aws_virtual_camera_integration_tool.py` - AWS 虛擬攝影機部署和測試
4. `github_deployment_tool.py` - GitHub 發佈和拉取

### 整合部署（推薦使用）

整合部署腳本結合了所有部署方式，是最簡單的使用方法：

```bash
# 使用所有部署方式
python integrated_deployment.py

# 只使用直接部署
python integrated_deployment.py --method direct

# 只使用 GitHub 部署
python integrated_deployment.py --method github --repo-dir /path/to/repo --repo-url https://github.com/username/repo.git

# 只部署 AWS 虛擬攝影機相關功能
python integrated_deployment.py --method aws-camera
```

### 直接部署

直接部署腳本通過 SSH/SCP 將檔案部署到目標裝置：

```bash
# 部署所有檔案
python deploy_to_device_cloud.py --ssh-key "qdc_id_2025-8-11_62.pem" --username hcktest --port 2222

# 只部署核心檔案
python deploy_to_device_cloud.py --core-only

# 測試 SSH 連線
python deploy_to_device_cloud.py --test-connection
```

### AWS 虛擬攝影機工具

AWS 虛擬攝影機工具用於部署和測試攝影機相關功能：

```bash
# 列出可用攝影機
python aws_virtual_camera_integration_tool.py list

# 測試指定攝影機（預設為 ID 1）
python aws_virtual_camera_integration_tool.py test --id 1 --duration 20

# 部署攝影機相關檔案
python aws_virtual_camera_integration_tool.py deploy --ssh-key "qdc_id_2025-8-11_62.pem" --username hcktest
```

### GitHub 部署工具

GitHub 部署工具用於將專案發佈到 GitHub，並從裝置拉取：

```bash
# 初始化 GitHub 倉庫
python github_deployment_tool.py init --repo-dir /path/to/repo --repo-url https://github.com/username/repo.git

# 發佈專案到 GitHub
python github_deployment_tool.py deploy --source-dir /path/to/source --repo-dir /path/to/repo

# 從 GitHub 拉取到裝置
python github_deployment_tool.py pull --ssh-key "key.pem" --target-dir "C:/dragon_x"

# 完整工作流程（初始化、發佈、拉取）
python github_deployment_tool.py workflow --source-dir /path/to/source --repo-dir /path/to/repo --ssh-key "key.pem"
```

## 常見參數說明

所有腳本支援以下常見參數：

- `--ssh-key`：SSH 密鑰檔案路徑（預設：`qdc_id_2025-8-11_62.pem`）
- `--username`：SSH 使用者名稱（預設：`hcktest`）
- `--port`：SSH 連接埠（預設：`2222`）
- `--target-dir`：目標裝置上的目標目錄（預設：`C:/dragon_x_fall_detection`）
- `--source-dir`：本地源代碼目錄（預設：當前目錄）

## 在 Windows 裝置上執行

部署完成後，您可以在 Windows 裝置上執行以下命令：

```bash
# 測試攝影機
python C:/dragon_x_fall_detection/aws_virtual_camera_test_windows.py --list

# 運行實時演示
python C:/dragon_x_fall_detection/snapdragon_realtime_demo_windows.py

# 運行視頻演示
python C:/dragon_x_fall_detection/snapdragon_video_demo_windows.py

# 運行效能基準測試
python C:/dragon_x_fall_detection/snapdragon_performance_benchmark_windows.py
```

## 常見問題解決

1. **SSH 連線失敗**
   - 確認 SSH 密鑰路徑正確
   - 確認使用者名稱和連接埠正確
   - 確認目標裝置可訪問

2. **攝影機無法打開**
   - 在 Windows 裝置上，通常使用攝影機 ID 1 而非 0
   - 使用 `--list` 選項檢查可用攝影機
   - 確認攝影機權限已授予

3. **GitHub 操作失敗**
   - 確認 GitHub 倉庫 URL 正確
   - 確認 Git 已在 Windows 裝置上安裝
   - 確認有足夠權限推送到倉庫

## 自動更新流程

設置 GitHub 部署後，可以使用以下流程進行自動更新：

1. 在 Mac 上開發並測試代碼
2. 推送到 GitHub：`python github_deployment_tool.py deploy`
3. 在 Windows 裝置上拉取更新：`cd C:/dragon_x_fall_detection && git pull`

此流程可以最大限度減少手動部署工作，特別適合頻繁更新的開發環境。

## 聯絡支援

如有部署問題，請聯絡：

- 技術支援：`support@example.com`
- 開發團隊：`dev@example.com`
